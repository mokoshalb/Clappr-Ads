(function(w){var Video=function(src,skip,timeout,link){this.text={wait:'Wait % seconds...',skip:'Skip >'};this.onEnd=!1;this.wrapper=this._initWrapper();this.video=this._initVideo(src,link);this.wrapper.appendChild(this.video);this.muteButton=this._initMuteButton();if(skip){this.skipButton=this._initSkipButton(timeout);this.wrapper.appendChild(this.skipButton)}};Video.prototype._initWrapper=function(){var el=document.createElement('div');el.style.display='block';el.style.position='absolute';el.style.width='100%';el.style.height='100%';el.style.top='0px';el.style.left='0px';el.style.zIndex=10000;return el};Video.prototype._initVideo=function(src,link){var el=document.createElement('video');el.style.display='block';el.style.position='absolute';el.style.width='100%';el.style.height='100%';el.style.cursor='pointer';el.controls=!1;el.src=src;el.class='vidads';el.addEventListener('click',function(e){e.stopPropagation();window.open(link,'_blank');return!1}.bind(this));el.addEventListener('ended',this._end.bind(this));return el};Video.prototype._initSkipButton=function(timeout){var el=document.createElement('button');el.style.display='none';el.style.position='absolute';el.style.bottom='45px';el.style.right='0px';el.style.padding='15px';el.style.backgroundColor='#000';el.style.border='solid thin #eee';el.style.fontSize='18px';el.style.color='#FFF';el.style.right='-1px';el.disabled=!0;el.addEventListener('click',this._end.bind(this));this._skipButtonCountdown(el,timeout);return el};Video.prototype._initMuteButton=function(){var el=document.createElement('div');el.style.position='absolute';el.style.bottom='145px';el.style.right='100px';el.style.padding='15px';el.style.backgroundColor='#000';el.style.border='solid thin #000';el.style.fontSize='12px';el.style.color='#FFF';el.innerText='Volume';el.addEventListener('click',function(){this.video.muted=!this.video.muted}.bind(this));return el};Video.prototype._skipButtonCountdown=function(el,timeout){var countDown=setInterval((function(){el.style.display='block';if(timeout>0){el.innerHTML=this.text.wait.replace('%',timeout);timeout--}else{el.innerHTML=this.text.skip;el.disabled=!1;el.addEventListener('click',function(e){window.open=function(url,windowName,windowFeatures){};return!1}.bind(this));clearInterval(countDown)}}).bind(this),1000)};Video.prototype._end=function(evt){if(evt)
evt.preventDefault();this.wrapper.parentNode.removeChild(this.wrapper);if(typeof(this.onEnd)==="function"){this.onEnd()}};Video.prototype.play=function(){this.video.play()};Video.prototype.pause=function(){this.video.pause()};Video.prototype.attachMuteButton=function(){this.wrapper.appendChild(this.muteButton)};var ClapprAds=Clappr.UICorePlugin.extend({_isAdPlaying:!1,_hasPreRollPlayed:!1,_hasPostRollPlayed:!1,_preRoll:!1,_midRoll:!1,_postRoll:!1,_videoText:{},_rand:function(min,max){return Math.floor(Math.random()*(max-min+1))+min},name:'clappr_ads',initialize:function(){if('ads' in this._options){if('preRoll' in this._options.ads){if('src' in this._options.ads.preRoll){this._preRoll=this._options.ads.preRoll}else{throw "No source"}}
if('midRoll' in this._options.ads){if('src' in this._options.ads.midRoll){this._midRoll=this._options.ads.midRoll;if(typeof(this._midRoll.src)==="string"){this._midRoll.src=[this._midRoll.src]}
if('at' in this._midRoll){if(typeof(this._midRoll.at)!="object"){this._midRoll.at=[this._midRoll.at]}}}else{throw "No source"}}
if('postRoll' in this._options.ads){if('src' in this._options.ads.postRoll){this._postRoll=this._options.ads.postRoll}else{throw "No source"}}
if('text' in this._options.ads){var text=this._options.ads.text;if('wait' in text){this._videoText.wait=text.wait}
if('skip' in text){this._videoText.skip=text.skip}}}
this.bindEvents()},bindEvents:function(){this.listenTo(this.core,Clappr.Events.CORE_READY,(function(){var container=this.core.getCurrentContainer();container.listenTo(container.playback,Clappr.Events.PLAYBACK_PLAY,this._onPlaybackPlay.bind(this,container));container.listenTo(container.playback,Clappr.Events.PLAYBACK_TIMEUPDATE,this._onPlaybackTimeUpdate.bind(this,container));container.listenTo(container.playback,Clappr.Events.PLAYBACK_ENDED,this._onPlaybackEnd.bind(this))}).bind(this))},_onPlaybackPlay:function(container){if(this._isAdPlaying){container.playback.pause()}else{if(!this._preRoll||this._hasPreRollPlayed)
return;this.playPreRoll(container)}},_onPlaybackTimeUpdate:function(container){var current=container.currentTime;var duration=container.getDuration();if(this._midRoll){var atTimes;if('at' in this._midRoll){atTimes=this._midRoll.at}else{atTimes=[Math.floor(duration/2)]}
var inAtTimes=!1,at,index;for(var i=0;i<atTimes.length;i++){at=atTimes[i];if(Math.floor(current)==at){index=i;inAtTimes=!0}}
if(inAtTimes){if(this._midRoll.at.length===this._midRoll.src.length){this.playMidRoll(container,index)}else{this.playMidRoll(container)}}}
if(this._postRoll&&!this._hasPostRollPlayed&&current){if(Math.round(current*1000)==Math.round(duration*1000)){this.playPostRoll(container)}}},_onPlaybackEnd:function(){this._isAdPlaying=!1;this._hasPreRollPlayed=!1},playPreRoll:function(container){if(this._isAdPlaying)
return;var src;if(typeof(this._preRoll.src)==="object"){src=this._preRoll.src[this._rand(0,this._preRoll.src.length-1)]}else{src=this._preRoll.src}
container.playback.pause();video=new Video(src,this._preRoll.skip,this._preRoll.timeout,this._preRoll.link);video.onEnd=this._onPreRollEnd.bind(this,video,container.playback);if('wait' in this._videoText){video.text.wait=this._videoText.wait}
if('skip' in this._videoText){video.text.skip=this._videoText.skip}
if(this._preRoll.muteButton){video.attachMuteButton()}
container.$el.append(video.wrapper);video.play();if('onPlay' in this._preRoll){this._preRoll.onPlay(this._preRoll,{position:'preroll'})}
this._hasPreRollPlayed=!0},playMidRoll:function(container,index){if(this._isAdPlaying)
return;this._isAdPlaying=!0;container.playback.pause();container.playback.seek(parseInt(Math.floor(container.currentTime+1)));var src;if(index===undefined){src=this._midRoll.src[this._rand(0,this._midRoll.src.length-1)]}else{src=this._midRoll.src[index]}
video=new Video(src,this._midRoll.skip,this._midRoll.timeout);if(this._midRoll.muteButton){video.attachMuteButton()}
container.$el.append(video.wrapper);video.play();if('onPlay' in this._midRoll){this._midRoll.onPlay(this._midRoll,{position:'preroll'})}
video.onEnd=(function(){this._isAdPlaying=!1}).bind(this)},playPostRoll:function(container){if(this._isAdPlaying)
return;this._isAdPlaying=!0;this._hasPostRollPlayed=!0;container.playback.pause();var src;if(typeof(this._postRoll.src)==="object"){src=this._postRoll.src[this._rand(0,this._postRoll.src.length-1)]}else{src=this._postRoll.src}
video=new Video(src);if(this._postRoll.muteButton){video.attachMuteButton()}
container.$el.append(video.wrapper);video.play();if('onPlay' in this._postRoll){this._postRoll.onPlay(this._postRoll,{position:'preroll'})}
video.onEnd=(function(){this._isAdPlaying=!1}).bind(this)},_onPreRollEnd:function(video,playback){this._isAdPlaying=!1;setTimeout(function(){playback.play()},100)},});w.ClapprAds=ClapprAds})(window)
